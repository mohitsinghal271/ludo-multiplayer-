import React from"react";import{socket}from"../lib/socket";const COLORS={red:"#e74c3c",green:"#2ecc71",yellow:"#f1c40f",blue:"#3498db"};export default function Board({me,room,game}){const myTurn=game&&room.players[room.turnIndex]?.id===me?.id,lastRoll=game?.state?.lastRoll?.n,doRoll=()=>{socket.emit("game:roll",{code:room.code},res=>{if(!res.ok)alert(res.error||"Roll failed")})},PATH_LEN=52,cells=Array.from({length:PATH_LEN}).map((e,t)=>t),cellOwner=e=>{const t=[];for(const o of game.players){const a=game.state.tokens[o.id];a.pos===e&&t.push({color:o.color,id:o.id})}return t};return(<div className="board-wrap"><div className="hud"><div><b>Room:</b> {room.code}</div><div><b>Status:</b> {room.status}</div><div><b>Turn:</b> {room.players[room.turnIndex]?.name}</div><div><b>Last Roll:</b> {lastRoll??"-"}</div>{game?.state?.winner&&<div className="winner">🏆 Winner: {game.players.find(e=>e.id===game.state.winner)?.name}</div>}</div><div className="board">{cells.map(e=>{const t=game?cellOwner(e):[];return(<div key={e} className="cell"><span className="idx">{e}</span><div className="tokens">{t.map(t=>(<span key={t.id} className="token" style={{background:COLORS[t.color]}} title={t.id}></span>))}</div></div>)})}</div><div className="panel"><ul className="players">{room.players.map(e=>(<li key={e.id} className={room.players[room.turnIndex].id===e.id?"active":""}><span className="dot" style={{background:COLORS[e.color]}}></span>{e.name} ({e.color}){ -1===game?.state?.tokens[e.id]?.pos?" — in yard":` — pos ${game?.state?.tokens[e.id]?.pos} lap ${game?.state?.tokens[e.id]?.laps}`}</li>))}</ul><button onClick={doRoll} disabled={!myTurn||game?.state?.winner}>Roll Dice</button>{myTurn?<div className="tip">It&apos;s your turn! Roll the dice.</div>:<div className="tip">Waiting for {room.players[room.turnIndex]?.name}...</div>}</div></div>)}