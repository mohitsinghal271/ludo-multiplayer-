import React,{useState}from"react";import{socket}from"../lib/socket";export default function Lobby({me,setMe,room,setRoom}){const[name,setName]=useState(""),[code,setCode]=useState("");const canStart=room&&room.players?.length>=2;const createRoom=()=>{socket.emit("room:create",{name},(res)=>{if(!res.ok)return alert(res.error||"Failed to create");setMe(res.you);setRoom(res.room)})};const joinRoom=()=>{socket.emit("room:join",{code,name},(res)=>{if(!res.ok)return alert(res.error||"Failed to join");setMe(res.you);setRoom(res.room)})};const startGame=()=>{socket.emit("game:start",{code:room.code},(res)=>{if(!res.ok)alert(res.error||"Cannot start")})};return(<div className="card"><h2>Lobby</h2>{!room?(<><div className="row"><input placeholder="Your name" value={name} onChange={e=>setName(e.target.value)}/></div><div className="row"><button onClick={createRoom}>Create Room</button></div><div className="row"><input placeholder="Enter room code" value={code} onChange={e=>setCode(e.target.value.toUpperCase())}/><button onClick={joinRoom}>Join</button></div></>):(<><p><b>Room:</b> {room.code}</p><ul className="players">{room.players?.map(p=>(<li key={p.id}><span className={"dot "+p.color}></span>{p.name} ({p.color})</li>))}</ul><button disabled={!canStart} onClick={startGame}>Start Game</button></>)}</div>)}